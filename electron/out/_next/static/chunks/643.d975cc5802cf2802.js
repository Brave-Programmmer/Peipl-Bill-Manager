"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[643],{70643:(e,t,n)=>{n.r(t),n.d(t,{default:()=>y});var i=n(95155),s=n(88661),l=n.n(s),r=n(43065),a=n(43517),o=n(54264),d=n.n(o),c=n(55172),m=n(12115),h=n(22663);let g=(0,r.v)(a.Q,{number:"number"}),x={normalizeToArray:e=>Array.isArray(e)?e:null==e||""===e?[]:[e],compileFormulas:e=>{let t={};return(e||[]).forEach(e=>{if("formula"===e.type&&e.formula)try{t[e.key]=g.compile(e.formula)}catch(e){}}),t},calculateRow(e,t,n){let i={...e};return t.forEach(e=>{if("formula"===e.type&&e.formula)try{let s={};t.forEach(e=>{s[e.key]=x.normalizeToArray(i[e.key])});let l=Math.max(...Object.values(s).map(e=>e.length),1),r=n[e.key]||g.compile(e.formula),a=[];for(let e=0;e<l;e++){let n={};t.forEach(t=>{let i=s[t.key],l=void 0!==i[e]?i[e]:i.length?i[0]:0;(""===l||null==l)&&(l=0),l=Number(l),n[t.key]=isNaN(l)?0:l});let i=r.evaluate(n);a.push("number"==typeof i?Number(i.toFixed(2)):i)}i[e.key]=1===a.length?a[0]:a}catch(t){i[e.key]="Err"}}),i}};function y(e){let{billData:t,companyInfo:n,isVisible:s,onClose:r,onEdit:a,onSaveBill:o}=e,[g,y]=(0,m.useState)(!1),[p,u]=(0,m.useState)(!1),f=t.columns||[{key:"srNoDate",label:"Sr. No. & Date"},{key:"refNo",label:"Ref No."},{key:"description",label:"Job Description"},{key:"sacHsn",label:"SAC/HSN"},{key:"quantity",label:"Qty"},{key:"rate",label:"Rate (₹)"},{key:"amount",label:"Taxable Value (₹)"},{key:"cgstAmount",label:"CGST (9%)"},{key:"sgstAmount",label:"SGST (9%)"},{key:"totalWithGST",label:"Total (₹)"}],j=(e,t)=>{let n=f.findIndex(t=>t.key===e);n>=0&&(f[n].formula||(f[n].formula=t),f[n].type="formula")};j("amount","quantity * rate"),j("cgstAmount","amount * 0.09"),j("sgstAmount","amount * 0.09"),j("totalWithGST","amount + cgstAmount + sgstAmount");let b=t.tableTitle||"Bill Items",N=(0,m.useMemo)(()=>x.compileFormulas(f),[f]),A=(0,m.useMemo)(()=>(t.items||[]).map((e,t)=>{let n={...e,srNoDate:void 0!==e.srNoDate?e.srNoDate:"".concat(t+1).concat(e.dates&&e.dates[0]?" / "+e.dates[0]:"")};return x.calculateRow(n,f,N)}),[t.items,f,N]),v=Number(t.rowsPerPage)||10,w=(0,m.useMemo)(()=>{let e=[];for(let t=0;t<A.length;t+=v)e.push(A.slice(t,t+v));return e},[A,v]);if(!s)return null;let S=e=>Array.isArray(e)?e.reduce((e,t)=>e+(parseFloat(t)||0),0):parseFloat(e)||0,T=()=>A.length?A.reduce((e,t)=>e+S(t.amount),0):0,E=()=>A.length?A.reduce((e,t)=>e+S(t.cgstAmount),0):0,I=()=>A.length?A.reduce((e,t)=>e+S(t.sgstAmount),0):0,k=()=>T()+E()+I();(0,m.useMemo)(()=>(()=>{let e={};return f.forEach(t=>{if("quantity"===t.key||"rate"===t.key||"amount"===t.key||"cgstAmount"===t.key||"sgstAmount"===t.key||"totalWithGST"===t.key){let n=0;A.forEach(e=>{let i=e[t.key];Array.isArray(i)?n+=i.reduce((e,t)=>e+(parseFloat(t)||0),0):n+=parseFloat(i)||0}),e[t.key]=n.toFixed(2)}}),e})(),[A,f]);let P=(()=>{let e={};return function t(n){let i;if(void 0!==e[n])return e[n];if(0===n)return e[n]="Zero";if(n<0)return e[n]="Negative "+t(Math.abs(n));let s=["","One","Two","Three","Four","Five","Six","Seven","Eight","Nine"];return i=n<10?s[n]:n<20?["Ten","Eleven","Twelve","Thirteen","Fourteen","Fifteen","Sixteen","Seventeen","Eighteen","Nineteen"][n-10]:n<100?["","","Twenty","Thirty","Forty","Fifty","Sixty","Seventy","Eighty","Ninety"][Math.floor(n/10)]+(n%10!=0?" "+s[n%10]:""):n<1e3?s[Math.floor(n/100)]+" Hundred"+(n%100!=0?" and "+t(n%100):""):n<1e5?t(Math.floor(n/1e3))+" Thousand"+(n%1e3!=0?" "+t(n%1e3):""):n<1e7?t(Math.floor(n/1e5))+" Lakh"+(n%1e5!=0?" "+t(n%1e5):""):t(Math.floor(n/1e7))+" Crore"+(n%1e7!=0?" "+t(n%1e7):""),e[n]=i}})(),D=e=>{try{let t=Math.round(100*(parseFloat(e)||0))/100,n=Math.floor(t),i=Math.round((t-n)*100),s=P(n)+" Rupees";return i>0&&(s+=" and "+P(i)+" Paise"),s+=" Only"}catch(e){return"Zero Rupees Only"}},C=async()=>{if(p)return;u(!0);let e=h.Ay.loading("Generating PDF..."),n=null;try{let i=document.getElementById("bill-content");if(!i){h.Ay.error("Bill content not found",{id:e}),u(!1);return}(n=document.createElement("div")).style.position="fixed",n.style.top="0",n.style.left="0",n.style.right="0",n.style.bottom="0",n.style.display="flex",n.style.alignItems="center",n.style.justifyContent="center",n.style.background="rgba(255,255,255,0.8)",n.style.zIndex="9999",n.innerHTML='<div style="text-align:center; font-weight:600; color:#111">Preparing PDF...</div>',document.body.appendChild(n),await new Promise(e=>setTimeout(e,120));let s=await d()(i,{scale:2,useCORS:!0,allowTaint:!0,backgroundColor:"#ffffff",logging:!1}),l=new c.Ay("p","mm","a4"),r=s.toDataURL("image/png"),a=s.width/210,o=s.height/a;if(o<=297)l.addImage(r,"PNG",0,(297-o)/2,210,o);else{let e=Math.floor(297*a),t=0;for(;t<s.height;){let n=Math.min(e,s.height-t),i=document.createElement("canvas");i.width=s.width,i.height=n,i.getContext("2d").drawImage(s,0,t,s.width,n,0,0,s.width,n);let r=i.toDataURL("image/png"),o=n/a;t>0&&l.addPage(),l.addImage(r,"PNG",0,0,210,o),t+=n}}let m="bill_".concat(t.billNumber||"invoice","_").concat(new Date().toISOString().slice(0,10),".pdf");l.save(m),h.Ay.success("PDF generated",{id:e})}catch(t){console.error("Error generating PDF:",t),h.Ay.error("Error generating PDF. Try simpler styles or remove gradients.",{id:e})}finally{u(!1),n&&n.parentNode&&n.parentNode.removeChild(n)}},B=e=>{let{rowsForPage:s=A,pageIndex:l=0,totalPages:r=1}=e,a=f.filter(e=>s.some(t=>Object.prototype.hasOwnProperty.call(t,e.key))),o=a.length>0?a:f,d=l===r-1;return(0,i.jsxs)("div",{className:"bg-white",style:{color:"#000",width:"200mm",minHeight:"280mm",margin:"0 auto",padding:"12mm"},children:[(0,i.jsx)("div",{style:{border:"1px solid #000",padding:"8px",marginBottom:"12px"},children:(0,i.jsxs)("div",{style:{textAlign:"center",padding:"8px"},children:[(0,i.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"center",gap:12,marginBottom:8},children:[(0,i.jsx)("div",{style:{width:72,height:72,position:"relative",display:"flex",alignItems:"center",justifyContent:"center",marginRight:8},children:(0,i.jsx)("img",{src:"./logo.png",alt:"Pujari Engineers Logo",width:56,height:56,style:{borderRadius:12},className:"object-contain"})}),(0,i.jsxs)("div",{children:[(0,i.jsx)("h1",{style:{fontSize:20,fontWeight:700,margin:0},children:"PUJARI ENGINEERS INDIA (P) LTD."}),(0,i.jsx)("p",{style:{margin:0,fontSize:12,fontWeight:600},children:"ONLINE LEAK SEALING • INSULATION HOT TIGHTING • METAL STITCHING"}),(0,i.jsx)("p",{style:{margin:0,fontSize:10,fontWeight:600},children:"SPARE PARTS SUPPLIERS & LABOUR SUPPLIERS"})]})]}),(0,i.jsxs)("div",{style:{fontSize:10},children:[(0,i.jsxs)("p",{style:{margin:2},children:[(0,i.jsx)("strong",{children:"Address:"})," ",(null==n?void 0:n.address)||"B-21, Flat No.101, Siddeshwar Co-op Hsg. Soc; Sector-9, Gharonda, Ghansoli, Navi, Mumbai -400 701."]}),(0,i.jsxs)("p",{style:{margin:2},children:[(0,i.jsx)("strong",{children:"Mobile:"})," ",(null==n?void 0:n.phone)||"9820027556"," ","\xa0 ",(0,i.jsx)("strong",{children:"Email:"})," ",(null==n?void 0:n.email)||"spujari79@gmail.com"]})]})]})}),(0,i.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"1fr 1fr",gap:16,marginBottom:12},children:[(0,i.jsxs)("div",{style:{border:"1px solid #000",padding:8},children:[(0,i.jsxs)("p",{style:{margin:0,fontWeight:700},children:["To, ",t.customerName||"Customer Name"]}),t.plantName&&(0,i.jsx)("p",{style:{margin:"4px 0 0 0"},children:t.plantName}),(0,i.jsx)("p",{style:{margin:"4px 0 0 0"},children:t.customerAddress||"Customer Address"}),(0,i.jsxs)("p",{style:{margin:"4px 0 0 0"},children:["Phone: ",t.customerPhone||"N/A"]}),(0,i.jsxs)("p",{style:{margin:"4px 0 0 0"},children:["GST: ",t.customerGST||"N/A"]})]}),(0,i.jsxs)("div",{style:{border:"1px solid #000",padding:8,fontSize:10},children:[(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[(0,i.jsx)("strong",{children:"Invoice No:"}),(0,i.jsx)("span",{children:t.billNumber||"PEIPLCH2526/001"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[(0,i.jsx)("strong",{children:"Date:"}),(0,i.jsx)("span",{children:(e=>{if(!e)return"N/A";let t=new Date(e);return isNaN(t.getTime())?"Invalid Date":t.toLocaleDateString("en-IN",{day:"2-digit",month:"2-digit",year:"numeric"})})(t.date)||"N/A"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2,alignItems:"center"},children:[(0,i.jsx)("strong",{children:"ORDER NO.:"}),(0,i.jsx)("span",{children:"GEMC-511687712601789"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[(0,i.jsx)("strong",{children:"JOBSHEET NO:"}),(0,i.jsx)("span",{children:"ATTACHED"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[(0,i.jsx)("strong",{children:"Outline Agreement:"}),(0,i.jsx)("span",{children:"4600002141"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[(0,i.jsx)("strong",{children:"Gem seller ID:"}),(0,i.jsx)("span",{children:"RXON210002099996"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:2},children:[(0,i.jsx)("strong",{children:"Vendor Code:"}),(0,i.jsx)("span",{children:"102237"})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,i.jsx)("strong",{children:"GSTIN:"}),(0,i.jsx)("span",{children:(null==n?void 0:n.gst)||(null==n?void 0:n.gstin)||"27AADCP2938G1ZD"})]})]})]}),(0,i.jsxs)("div",{style:{overflowX:"auto",marginBottom:12},children:[(0,i.jsxs)("h3",{style:{fontWeight:700,fontSize:16,background:"#f3f4f6",padding:4},children:[b," ",r>1?"— Page ".concat(l+1," of ").concat(r):""]}),(0,i.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:10},children:[(0,i.jsx)("thead",{children:(0,i.jsx)("tr",{children:o.map(e=>(0,i.jsx)("th",{style:R,children:e.label},e.key))})}),(0,i.jsx)("tbody",{children:s&&0!==s.length?s.map((e,t)=>(0,i.jsx)("tr",{children:o.map(t=>{var n;let s=null!=(n=e[t.key])?n:"";return Array.isArray(s)?(0,i.jsx)("td",{className:"border border-gray-950 px-2 py-2 text-xs text-black break-words",children:s.map((e,t)=>(0,i.jsx)("div",{children:e},t))},t.key):(0,i.jsx)("td",{className:"border border-gray-950 px-2 py-2 text-xs text-black break-words",children:s},t.key)})},e.id||t)):(0,i.jsx)("tr",{children:(0,i.jsx)("td",{colSpan:o.length,className:"border border-gray-950 px-2 py-2 text-xs text-center text-black",children:"No items found"})})})]})]}),d?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{style:{marginBottom:12,border:"1px solid #000",padding:8},children:(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[(0,i.jsxs)("div",{style:{flex:1},children:[(0,i.jsxs)("p",{style:{margin:0,fontSize:12,fontWeight:600},children:["Subtotal: ₹",T().toFixed(2)]}),(0,i.jsxs)("p",{style:{margin:0,fontSize:12,fontWeight:600},children:["CGST (9%): ₹",E().toFixed(2)]}),(0,i.jsxs)("p",{style:{margin:0,fontSize:12,fontWeight:600},children:["SGST (9%): ₹",I().toFixed(2)]})]}),(0,i.jsx)("div",{style:{textAlign:"right"},children:(0,i.jsxs)("p",{style:{margin:0,fontSize:16,fontWeight:700,borderTop:"2px solid #000",paddingTop:4},children:["Total: ₹",k().toFixed(2)]})})]})}),(0,i.jsxs)("div",{style:{marginBottom:12,border:"1px solid #000",padding:8},children:[(0,i.jsx)("strong",{children:"Amount in Words: "}),(0,i.jsx)("span",{style:{fontWeight:"bold",fontSize:"1.1em"},children:D(k())})]}),(0,i.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:24},children:[(0,i.jsxs)("div",{style:{flex:1,padding:2},children:[(0,i.jsx)("p",{className:"text-sm",style:{margin:0,fontWeight:500},children:"BILL IS PAYABLE WITHIN THIRTY DAYS"}),(0,i.jsx)("p",{className:"text-sm",style:{margin:0,fontWeight:500},children:"ALL PAYMENT TO BE MADE BY A/C PAYEE / DRAFT"}),(0,i.jsx)("p",{className:"text-sm",style:{margin:0,fontWeight:500},children:"IN FAVOUR OF PUJARI ENGINEERS INDIA (P) LTD."}),(0,i.jsx)("p",{className:"text-sm",style:{margin:0,fontWeight:500},children:"GSTIN: 27AADCP2938G1ZD"})]}),(0,i.jsxs)("div",{style:{width:300,textAlign:"center",position:"relative"},children:[(0,i.jsxs)("div",{style:{marginBottom:8},children:[(0,i.jsx)("p",{style:{margin:0,fontWeight:500},children:"For PUJARI ENGINEERS INDIA PVT. LTD."}),(0,i.jsxs)("div",{style:{marginTop:28},children:[(0,i.jsx)("p",{style:{margin:0,fontWeight:500},children:"SANDEEP. D.PUJARI"}),(0,i.jsx)("p",{style:{margin:0,fontSize:10},children:"(Director)"})]})]}),(0,i.jsx)("div",{style:{position:"absolute",left:"50%",top:"35%",transform:"translate(-50%,-50%)",opacity:.75},children:(0,i.jsx)("img",{src:"./stamp.png",alt:"Company Stamp",width:80,height:80,className:"object-contain"})})]})]})]}):(0,i.jsxs)("div",{style:{marginTop:12,display:"flex",justifyContent:"space-between",gap:12,alignItems:"flex-end"},children:[(0,i.jsxs)("div",{style:{flex:1,padding:2},children:[(0,i.jsx)("p",{className:"text-sm",style:{margin:0,fontWeight:500},children:"BILL IS PAYABLE WITHIN THIRTY DAYS"}),(0,i.jsx)("p",{className:"text-sm",style:{margin:0,fontWeight:500},children:"ALL PAYMENT TO BE MADE BY A/C PAYEE / DRAFT"}),(0,i.jsx)("p",{className:"text-sm",style:{margin:0,fontWeight:500},children:"IN FAVOUR OF PUJARI ENGINEERS INDIA (P) LTD."}),(0,i.jsx)("p",{className:"text-sm",style:{margin:0,fontWeight:500},children:"GSTIN: 27AADCP2938G1ZD"})]}),(0,i.jsx)("div",{style:{width:80,textAlign:"center",opacity:.85},children:(0,i.jsx)("img",{src:"./stamp.png",alt:"Stamp",width:60,height:60,className:"object-contain"})})]})]})},R={border:"1px solid #000",padding:"6px",textAlign:"left",fontSize:10,background:"#fff"};return(0,i.jsx)(i.Fragment,{children:g?(0,i.jsxs)("div",{className:"jsx-2d76ae9e56b57c7 fixed inset-0 bg-white z-50 overflow-y-auto print:overflow-visible",children:[(0,i.jsx)("button",{onClick:()=>y(!1),className:"jsx-2d76ae9e56b57c7 print:hidden fixed top-4 left-4 z-50 bg-gray-800 text-white px-3 py-2 text-sm font-semibold",children:"← Back"}),(0,i.jsxs)("div",{id:"bill-content",className:"jsx-2d76ae9e56b57c7 p-4 print:p-0 print:m-0",children:[w.map((e,n)=>(0,i.jsx)("div",{style:{width:"200mm",minHeight:"280mm",margin:"0 auto",pageBreakAfter:"always"},className:"jsx-2d76ae9e56b57c7",children:(0,i.jsx)(B,{rowsForPage:e,pageIndex:n,totalPages:w.length+(t.manualExtraPages||0)})},"pp-".concat(n))),Array.from({length:t.manualExtraPages||0}).map((e,t)=>(0,i.jsx)("div",{style:{width:"200mm",minHeight:"280mm",margin:"0 auto",pageBreakAfter:"always"},className:"jsx-2d76ae9e56b57c7",children:(0,i.jsx)("div",{style:{border:"1px solid #000",padding:8,marginBottom:12},className:"jsx-2d76ae9e56b57c7",children:(0,i.jsx)("div",{style:{textAlign:"center",padding:8},className:"jsx-2d76ae9e56b57c7",children:(0,i.jsxs)("h3",{style:{margin:0,fontWeight:700},className:"jsx-2d76ae9e56b57c7",children:[b," — Page ",w.length+t+1]})})})},"pp-manual-".concat(t)))]}),(0,i.jsx)(l(),{id:"2d76ae9e56b57c7",children:"@media print{body.jsx-2d76ae9e56b57c7{margin:0}#bill-content.jsx-2d76ae9e56b57c7{width:200mm!important;min-height:287mm!important}}e\n          "})]}):(0,i.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,i.jsxs)("div",{className:"bg-white shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-y-auto relative border border-gray-900",children:[(0,i.jsx)("button",{onClick:r,className:"print:hidden absolute top-4 right-4 z-10 bg-red-600 text-white w-8 h-8 flex items-center justify-center",children:"✕"}),(0,i.jsxs)("div",{className:"absolute top-4 left-4 z-10 flex space-x-2",children:[(0,i.jsx)("button",{onClick:()=>{try{let e={...t,companyInfo:n,savedAt:new Date().toISOString(),subtotal:T(),totalCGST:E(),totalSGST:I(),total:k(),amountInWords:D(k())};o&&o(e);let i=new Blob([JSON.stringify(e,null,2)],{type:"application/json"}),s=URL.createObjectURL(i),l=document.createElement("a");l.href=s,l.download="bill_".concat(t.billNumber||"invoice","_").concat(new Date().toISOString().slice(0,10),".json"),l.click(),URL.revokeObjectURL(s),h.Ay.success("Bill saved")}catch(e){console.error(e),h.Ay.error("Error saving bill")}},className:"bg-green-600 text-white px-4 py-2 text-sm font-semibold",children:"\uD83D\uDCBE Save JSON"}),(0,i.jsx)("button",{onClick:C,disabled:p,className:"bg-blue-600 text-white px-4 py-2 text-sm font-semibold",children:p?"Generating...":"\uD83D\uDCC4 PDF"}),(0,i.jsx)("button",{onClick:()=>{y(!0),setTimeout(()=>{window.print()},150)},className:"bg-purple-600 text-white px-4 py-2 text-sm font-semibold",children:"\uD83D\uDDA8️ Print"}),(0,i.jsx)("button",{onClick:a,className:"bg-gray-600 text-white px-4 py-2 text-sm font-semibold",children:"✏️ Edit"})]}),(0,i.jsxs)("div",{id:"bill-content",className:"p-6 pt-16",children:[w.map((e,n)=>(0,i.jsx)("div",{style:{width:"200mm",minHeight:"280mm",margin:"0 auto",pageBreakAfter:"always"},children:(0,i.jsx)(B,{rowsForPage:e,pageIndex:n,totalPages:w.length+(t.manualExtraPages||0)})},"page-".concat(n))),Array.from({length:t.manualExtraPages||0}).map((e,t)=>(0,i.jsx)("div",{style:{width:"200mm",minHeight:"280mm",margin:"0 auto",pageBreakAfter:"always"},children:(0,i.jsx)("div",{style:{border:"1px solid #000",padding:8,marginBottom:12},children:(0,i.jsx)("div",{style:{textAlign:"center",padding:8},children:(0,i.jsxs)("h3",{style:{margin:0,fontWeight:700},children:[b," — Page ",w.length+t+1]})})})},"manual-".concat(t)))]})]})})})}}}]);